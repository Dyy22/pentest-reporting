import json

def menu():
    print('\nAutomation Reporting Generator\n')
    print("1. SQL Injection                 4. IDOR (Isecure Direct Object Reference)   7. Broken Authentication")
    print("2. XSS (Site Cross Scripting)    5. HTML Injection                           8. Broken Access Control")
    print("3. RCE (Remote Code Execution)   6. Security Misconfiguration                9. XXE (XML External Entities)")
    report_type = input("\n[+] Pilih Report: ")

    try:
       report_type = int(report_type)
    except ValueError:
        print("Input tidak valid. Keluar.")
        exit()

    if report_type > 9 or report_type < 1:
        print("Input salah")
        keluar = input("Kembali ke menu? (Y/n): ").lower()
        if keluar.lower() == "y" or report_type == "":
            menu()
        elif keluar.lower() == "n":
            exit()
        else:
            print("Input tidak valid. Keluar.")
            exit()
    
    generate_template(report_type)

def generate_template(report_type):
    templates = json.load(open('templates.json', 'r'))

    report_name = templates[report_type - 1].get("name")
              
    print("\n              ..::%s Report::.." % (report_name))
    language = input('Pilih Bahasa (contoh: ID/en): ')
    if language == "" or language.lower() == "id": language = "id"
    elif language.lower() == "en": language = "en"
    else : 
        print("Input salah")
        keluar = input("Kembali ke menu? (Y/n): ")
        if keluar == "" or keluar.lower() == "y":
            menu()
        elif keluar.lower() == "n":
            exit()
        else:
            print("Input tidak valid. Keluar.")
            exit()

    t_instansi = input('Nama Perusahaan: ')
    t_domain = input('Domain: ')
    sender = input('Nama Pengirim: ')
    job = input('Title/Posisi: ')
    email = input('Email: ')
    telp = input('Telepon: ')
    loc = "" if report_type == 6 or report_type == 7 else input('Lokasi Temuan (contoh: form/parameter): ')

    content_template = templates[report_type - 1].get("template").get(language).format(t_instansi, t_domain, loc, sender, job, email, telp)

    print('----------------------------------------------------------------------------------------\n')
    print(content_template)
    print('----------------------------------------------------------------------------------------\n')

    pilihan = input("Apakah ingin menyimpan file? (Y/n): ").lower()
    if pilihan == 'y' or pilihan == "":
        nama_file = input("Nama File: ")
        with open(nama_file, 'w') as file:
            file.write(content_template)
        print('sukses')
    else:
        exit()

menu()
